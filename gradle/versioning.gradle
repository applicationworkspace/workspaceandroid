def INITIAL_VERSION = 52

ext {
    appSetup = [
            majorVersion: 1,   // 1..âˆž
            minorVersion: 0,    // 0..99
            patchVersion: 0     // 0..999
    ]

    calculateVersionCode = {
//        def pipelineRunId = System.getenv("PIPELINE_RUN_NUMBER")
//        def pipelineRunId = System.getenv("CIRCLE_BUILD_NUM")
        def major = appSetup.majorVersion as int
        def minor = appSetup.minorVersion as int
        def patch = appSetup.patchVersion as int
        return (major * 100 + minor) * 1000 + patch
    }

    calculateVersionName = {
        def pipelineRunId = System.getenv("BUILD_NUMBER") ?: 0
//        def pipelineRunId = System.getenv("CIRCLE_BUILD_NUM") ?: 0
        "${appSetup.majorVersion}.${appSetup.minorVersion}.${appSetup.patchVersion}-$pipelineRunId"
    }
}

//// Circle ci BUILD_NUM
//static def getBuildVersion() {
//    def version = 32
//    def buildNumber = System.getenv("CIRCLE_BUILD_NUM")
//    if (buildNumber != null) {
//        version += buildNumber as int
//    }
//    println("VersionCode: " + version)
//    return version
//}